#!/usr/bin/env ruby
# Executable documentation

# Valid syntax for deployment test annotations
# Nesting is not supported.
# 1. Single line annotation, not visibile in Markdown output
#  "<!-- deploy-test name [VALUE]* -->"
# 2. Hidden multiline annotation
#  "<!-- deploy-test-start name [VALUE]*"
#  CONTENT
#  "-->"
# 3. Visible multiline annotation
#  "<!-- deploy-test-start name [VALUE]* -->"
#  CONTENT
#  "<!-- deploy-test-end -->"
require_relative "../lib/doc-tests"

name = ARGV.first

test = DeploymentTest.find!(name)
Dir.chdir test.deployment_directory

puts test.plan.to_s
puts

if test.plan.execute!
  exit 0
else
  exit 1
end
